<header class="bg-[#2A4759] shadow-md p-4 lg:px-20 px-4 flex justify-between items-center z-50 relative">
  <div class="flex items-center gap-3">

    <button onclick="window.history.back()" 
            class="lg:hidden text-white text-xl hover:text-[#FC8500]">
      <i class="fa-solid fa-arrow-right"></i> 
    </button>

    <img src="/images/logo.png" alt="logo" class="h-8 lg:h-10 w-auto rounded-md" />
  </div>

  <nav class="hidden lg:block">
    <ul class="flex gap-8 text-white font-medium items-center">
      <li><a href="/" class="hover:underline hover:text-[#FC8500]">الرئيسية</a></li>
      <li><a href="/showMoreTechnicians" class="hover:underline hover:text-[#FC8500]">الفنيين</a></li>
      <li class="relative group">
        <button class="hover:text-[#FC8500] flex items-center gap-1">
          المدونة
          <i class="fa-solid fa-chevron-down text-xs group-hover:rotate-180 transition-transform"></i>
        </button>
        <ul class="absolute right-0 mt-2 w-48 bg-white text-[#2A4759] rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all">
          <% if (locals.blogs && blogs.length > 0) { %>
            <% blogs.forEach(blog => { %>
              <li>
                <a href="/blogs/<%= getSlug(blog.blog, { lang: false, uric: true }) %>" class="block px-4 py-3 hover:bg-[#2A4759] hover:text-white">
                  <%= blog.blog %>
                </a>
              </li>
            <% }) %>
          <% } else { %>
            <li><span class="block px-4 py-3 text-gray-400">لا توجد مقالات</span></li>
          <% } %>
        </ul>
      </li>
<li>
  <a href="https://wa.me/<%= mainPhone %>" 
     class="hover:underline hover:text-[#FC8500]">
    تواصل معنا
  </a>
</li>
    </ul>
  </nav>

  <div class="hidden lg:block">
   <a href="tel:<%= mainPhone %>" class="text-white hover:text-[#FC8500] flex items-center gap-2">
  <i class="fa-solid fa-phone text-sm"></i>
  <span class="hidden xl:inline">اتصل بنا:</span>
  <%= mainPhone %>
</a>

  </div>

  <div class="flex lg:hidden items-center gap-4">
    <div class="relative">
      <button id="mobileSearchBtn" class="text-white text-xl">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
      <div id="mobileSearchWrapper" class="absolute top-0 left-8 hidden">
        <form action="/showMoreTechnicians" method="GET" class="flex items-center">
          <div class="relative">
            <input type="text" id="search-mobile" name="search" placeholder="ابحث عن فني"
              class="w-0 max-w-[110px] transition-all duration-200 border border-gray-300 rounded-[12px] py-1 pl-3 pr-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-[#2A4759]" />
            <ul id="autocomplete-list-mobile" class="absolute z-50 bg-[#FAFAFA] w-full mt-1 rounded-lg"></ul>
          </div>
        </form>
      </div>
    </div>

    <a href="tel:05075813050" class="text-white text-xl hover:text-[#FC8500]">
      <i class="fa-solid fa-phone"></i>
    </a>

    <button id="mobileMenuBtn" class="text-white text-xl" aria-expanded="false" aria-controls="mobileMenu">
      <i class="fa-solid fa-bars" id="hamburgerIcon"></i>
      <i class="fa-solid fa-times hidden" id="closeIcon"></i>
    </button>
  </div>

  <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>

  <div id="mobileMenu"
     class="lg:hidden fixed top-0 right-0 h-full w-3/4 bg-[#2A4759] z-50 overflow-y-auto"
     style="transform: translateX(100%); transition: transform 300ms ease;">
  <nav class="py-6">
    <ul class="space-y-1 divide-y divide-[#406A84]">
      <li>
        <a href="/" class="flex items-center gap-3 px-6 py-3 text-white hover:bg-[#406A84]">
          <i class="fa-solid fa-house text-sm"></i>
          الرئيسية
        </a>
      </li>
      <li>
        <a href="/showMoreTechnicians" class="flex items-center gap-3 px-6 py-3 text-white hover:bg-[#406A84]">
          <i class="fa-solid fa-screwdriver-wrench text-sm"></i>
          الفنيين
        </a>
      </li>
      <li>
        <button id="mobileBlogBtn" 
                class="w-full flex justify-between items-center px-6 py-3 text-white hover:bg-[#406A84]">
          <span class="flex items-center gap-3">
            <i class="fa-solid fa-blog text-sm"></i>
            المدونة
          </span>
          <i class="fa-solid fa-chevron-down text-xs transition-transform" id="mobileBlogIcon"></i>
        </button>

        <ul id="mobileBlogList" class="hidden text-white divide-y divide-[#406A84] ">
          <% if (locals.blogs && blogs.length > 0) { %>
            <% blogs.forEach(blog => { %>
              <li class="pr-12" >
                <a href="/blogs/<%= getSlug(blog.blog, { lang: false, uric: true }) %>" 
                   class="block px-4 py-3 hover:bg-[#406A84] hover:text-white">
                  <%= blog.blog %>
                </a>
              </li>
            <% }) %>
          <% } else { %>
            <li>
              <span class="block px-8 py-2 text-gray-300">لا توجد مقالات</span>
            </li>
          <% } %>
        </ul>
      </li>
      <li>
        <a href="https://wa.me/05075813050" class="flex items-center gap-3 px-6 py-3 text-white hover:bg-[#406A84]">
          <i class="fa-solid fa-phone text-sm"></i>
          تواصل معنا
        </a>
      </li>
    </ul>
  </nav>
</div>

</header>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const mobileSearchBtn = document.getElementById('mobileSearchBtn');
  const mobileSearchWrapper = document.getElementById('mobileSearchWrapper');
  const mobileSearchInput = document.getElementById('search-mobile');

  if (mobileSearchBtn) {
    mobileSearchBtn.addEventListener('click', () => {
      if (!mobileSearchWrapper) return;
      mobileSearchWrapper.classList.toggle('hidden');
      if (!mobileSearchWrapper.classList.contains('hidden')) {
        if (mobileSearchInput) {
          mobileSearchInput.classList.remove('w-0');
          mobileSearchInput.classList.add('w-48','px-3');
          mobileSearchInput.focus();
        }
      } else {
        if (mobileSearchInput) {
          mobileSearchInput.classList.remove('w-48','px-3');
          mobileSearchInput.classList.add('w-0');
        }
      }
    });
  }

  if (typeof setupAutocomplete === 'function') {
    setupAutocomplete('search-mobile', 'autocomplete-list-mobile');
  }

  const mobileMenuBtn = document.getElementById('mobileMenuBtn');
  const mobileMenu = document.getElementById('mobileMenu');
  const hamburgerIcon = document.getElementById('hamburgerIcon');
  const closeIcon = document.getElementById('closeIcon');
  const overlay = document.getElementById('overlay');

  if (mobileMenu && mobileMenuBtn) {
    const openMenu = () => {
      mobileMenu.style.transform = 'translateX(0)';
      overlay.classList.remove('hidden');
      mobileMenuBtn.setAttribute('aria-expanded', 'true');
      if (hamburgerIcon) hamburgerIcon.classList.add('hidden');
      if (closeIcon) closeIcon.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    };

    const closeMenu = () => {
      mobileMenu.style.transform = 'translateX(100%)';
      overlay.classList.add('hidden');
      mobileMenuBtn.setAttribute('aria-expanded', 'false');
      if (hamburgerIcon) hamburgerIcon.classList.remove('hidden');
      if (closeIcon) closeIcon.classList.add('hidden');
      document.body.style.overflow = '';
    };

    mobileMenuBtn.addEventListener('click', () => {
      const isOpen = mobileMenu.style.transform === 'translateX(0)';
      if (isOpen) closeMenu(); else openMenu();
    });

    overlay.addEventListener('click', closeMenu);

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeMenu();
    });

    mobileMenu.addEventListener('click', (e) => {
      if (e.target.tagName === 'A') setTimeout(closeMenu, 50);
    });
  }

  const mobileBlogBtn = document.getElementById('mobileBlogBtn');
  const mobileBlogList = document.getElementById('mobileBlogList');
  const mobileBlogIcon = document.getElementById('mobileBlogIcon');

  if (mobileBlogBtn) {
    mobileBlogBtn.addEventListener('click', (e) => {
      e.preventDefault();
      if (mobileBlogList) mobileBlogList.classList.toggle('hidden');
      if (mobileBlogIcon) mobileBlogIcon.classList.toggle('rotate-180');
    });
  }
});
</script>
