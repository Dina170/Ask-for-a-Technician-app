<header class="bg-[#2A4759] shadow-md p-4 lg:px-20 px-4 flex justify-between items-center z-50 relative">
 <div class="flex items-center">
  <a href="/">
    <img src="/images/logo2.png" alt="logo" class="h-8 lg:h-10 w-auto rounded-md" />
  </a>
</div>


  <nav class="hidden lg:block">
    <ul class="flex gap-8 text-white font-medium items-center">
      <li><a href="/" class="hover:underline hover:text-[#FC8500]">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
      <li><a href="/showMoreTechnicians" class="hover:underline hover:text-[#FC8500]">Ø§Ù„ÙÙ†ÙŠÙŠÙ†</a></li>
      <li class="relative group">
        <button class="hover:text-[#FC8500] flex items-center gap-1">
          Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©
          <i class="fa-solid fa-chevron-down text-xs group-hover:rotate-180 transition-transform"></i>
        </button>
        <ul class="absolute right-0 mt-2 w-48 bg-white text-[#2A4759] rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all">
          <% if (locals.blogs && blogs.length > 0) { %>
            <% blogs.forEach(blog => { %>
              <li>
                <a href="/blogs/<%= encodeURIComponent(blog.slug) %>"
                   class="block px-4 py-3 hover:bg-[#2A4759] hover:text-white">
                  <%= blog.blog %>
                </a>
              </li>
            <% }) %>
          <% } else { %>
            <li><span class="block px-4 py-3 text-gray-400">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‚Ø§Ù„Ø§Øª</span></li>
          <% } %>
        </ul>
      </li>
      <li>
        <a href="https://wa.me/<%= mainPhone %>" 
           class="hover:underline hover:text-[#FC8500]">
          ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§
        </a>
      </li>
    </ul>
  </nav>

  <div class="hidden lg:block">
    <a href="tel:<%= mainPhone %>" class="text-white hover:text-[#FC8500] flex items-center gap-2">
      <i class="fa-solid fa-phone text-sm"></i>
      <span class="hidden xl:inline">Ø§ØªØµÙ„ Ø¨Ù†Ø§:</span>
      <%= mainPhone %>
    </a>
  </div>

  <div class="flex lg:hidden items-center gap-4">
    <!-- ğŸ”¹ ØªØ¹Ø¯ÙŠÙ„: Ø¥Ø¶Ø§ÙØ© data-slug -->
    <div class="relative" 
         data-search-type="<%= searchType %>" 
         data-slug="<%= typeof technician !== 'undefined' && technician && technician.slug ? technician.slug : '' %>">
      <button id="mobileSearchBtn" class="text-white text-md">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
      <div id="mobileSearchWrapper" class="absolute top-0 left-6 hidden">
        <form method="GET" class="flex items-center" id="mobileSearchForm">
          <div class="relative w-full">
            <input type="text" id="search-mobile" name="search" placeholder="Ø§Ø¨Ø­Ø«..." 
              class="w-0 max-w-[90px] text-[12px] transition-all duration-200 border border-gray-300 rounded-[12px] py-1 pl-3 pr-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-[#2A4759]" />
            <ul id="autocomplete-list-mobile" class="absolute z-50 bg-[#FAFAFA] w-full mt-1 rounded-lg shadow-lg max-h-60 overflow-y-auto"></ul>
          </div>
        </form>
      </div>
    </div>

    <a href="tel:<%= mainPhone %>" class="text-white text-xl hover:text-[#FC8500]">
      <i class="fa-solid fa-phone"></i>
    </a>

    <button id="mobileMenuBtn" class="text-white text-xl" aria-expanded="false" aria-controls="mobileMenu">
      <i class="fa-solid fa-bars" id="hamburgerIcon"></i>
      <i class="fa-solid fa-times hidden" id="closeIcon"></i>
    </button>
  </div>

  <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>

  <div id="mobileMenu"
     class="lg:hidden fixed top-0 right-0 h-full w-3/4 bg-[#2A4759] z-50 overflow-y-auto"
     style="transform: translateX(100%); transition: transform 300ms ease;">
    <nav class="py-6">
      <ul class="space-y-1 divide-y divide-[#406A84]">
        <li>
          <a href="/" class="flex items-center gap-3 px-6 py-3 text-white hover:bg-[#406A84]">
            <i class="fa-solid fa-house text-sm"></i>
            Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
          </a>
        </li>
        <li>
          <a href="/showMoreTechnicians" class="flex items-center gap-3 px-6 py-3 text-white hover:bg-[#406A84]">
            <i class="fa-solid fa-screwdriver-wrench text-sm"></i>
            Ø§Ù„ÙÙ†ÙŠÙŠÙ†
          </a>
        </li>
        <li>
          <button id="mobileBlogBtn" 
                  class="w-full flex justify-between items-center px-6 py-3 text-white hover:bg-[#406A84]">
            <span class="flex items-center gap-3">
              <i class="fa-solid fa-blog text-sm"></i>
              Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©
            </span>
            <i class="fa-solid fa-chevron-down text-xs transition-transform" id="mobileBlogIcon"></i>
          </button>

          <ul id="mobileBlogList" class="hidden text-white divide-y divide-[#406A84] ">
            <% if (locals.blogs && blogs.length > 0) { %>
              <% blogs.forEach(blog => { %>
                <li class="pr-12" >
                 <a href="/blogs/<%= encodeURIComponent(blog.slug) %>"
                     class="block px-4 py-3 hover:bg-[#406A84] hover:text-white">
                    <%= blog.blog %>
                  </a>
                </li>
              <% }) %>
            <% } else { %>
              <li>
                <span class="block px-8 py-2 text-gray-300">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‚Ø§Ù„Ø§Øª</span>
              </li>
            <% } %>
          </ul>
        </li>
        <li>
          <a href="https://wa.me/<%= mainPhone %>" class="flex items-center gap-3 px-6 py-3 text-white hover:bg-[#406A84]">
            <i class="fa-brands fa-whatsapp text-sm"></i>
            ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§
          </a>
        </li>
      </ul>
    </nav>
  </div>
</header>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const mobileSearchWrapper = document.getElementById('mobileSearchWrapper');
  const mobileSearchInput = document.getElementById('search-mobile');
  const mobileSearchForm = document.getElementById('mobileSearchForm');
  const mobileSearchBtn = document.getElementById('mobileSearchBtn');
  const searchContainer = mobileSearchWrapper?.parentElement;
  const searchType = searchContainer?.dataset.searchType;

  let selectedPost = null;

  if (searchType && mobileSearchInput && mobileSearchForm) {
    switch(searchType) {
      case "technician":
        mobileSearchInput.placeholder = "Ø§Ø¨Ø­Ø« Ø¹Ù† ÙÙ†ÙŠ";
        mobileSearchForm.action = "/showMoreTechnicians";
        break;
      case "neighborhood":
        mobileSearchInput.placeholder = "Ø§Ø¨Ø­Ø« Ø¹Ù† Ø­ÙŠ";
        const techSlug = searchContainer.dataset.slug || '';
        mobileSearchForm.action = techSlug 
          ? `/technicians/Ø¹Ø±Ø¶-Ø§Ù„Ø§Ø­ÙŠØ§Ø¡/${techSlug}` 
          : "/showMoreTechnicians";
        break;
      case "blog":
        mobileSearchInput.placeholder = "Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù‚Ø§Ù„";
        mobileSearchForm.addEventListener('submit', (e) => {
          e.preventDefault();
          const query = mobileSearchInput.value.trim();
          if (query && searchType === "blog") {
            searchAndDisplayPost(query);
          }
        });
        break;
    }
  }

  if (mobileSearchBtn && mobileSearchWrapper && mobileSearchInput) {
    mobileSearchBtn.addEventListener('click', () => {
      const isHidden = mobileSearchWrapper.classList.contains('hidden');
      
      if (isHidden) {
        mobileSearchWrapper.classList.remove('hidden');
        mobileSearchInput.classList.remove('w-0');
        mobileSearchInput.classList.add('w-48','px-3');
        mobileSearchInput.focus();
      } else {
        const query = mobileSearchInput.value.trim();
        
        if (query) {
          switch(searchType) {
            case "blog":
              searchAndDisplayPost(query);
              break;
            case "technician":
              searchAndDisplayTechnician(query);
              break;
            case "neighborhood":
              searchAndDisplayNeighborhood(query);
              break;
          }
        } else {
          mobileSearchWrapper.classList.add('hidden');
          mobileSearchInput.classList.remove('w-48','px-3');
          mobileSearchInput.classList.add('w-0');
        }
      }
    });
  }

  // ğŸ”¹ Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« Ù„Ù„Ù…Ù‚Ø§Ù„Ø§Øª
  async function searchAndDisplayPost(query) {
    try {
      const url = `/search/autocomplete?q=${encodeURIComponent(query)}&type=blog`;
      const res = await fetch(url);
      if (!res.ok) throw new Error('Network response was not ok');
      
      const items = await res.json();
      console.log('Blog Search Results:', items);

      const list = document.getElementById("autocomplete-list-mobile");
      list.innerHTML = "";
      list.classList.add("hidden");

      const postToDisplay = selectedPost || (items.length === 1 ? items[0] : null);
      
      if (postToDisplay) {
        displaySinglePostCard(postToDisplay);
        selectedPost = null;
      } else if (items.length > 1) {
        displayMultiplePostsCards(items);
      } else {
        displayNoResults(query, 'blog');
      }
    } catch(err) {
      console.error("Blog search error:", err);
      displayError();
    }
  }

  // ğŸ”¹ Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« Ù„Ù„ÙÙ†ÙŠÙŠÙ†
async function searchAndDisplayTechnician(query) {
  try {
    const url = `/search/autocomplete?q=${encodeURIComponent(query)}&type=technician`;
    const res = await fetch(url);
    if (!res.ok) throw new Error('Network response was not ok');
    
    const items = await res.json();
    console.log('Technician Search Results:', items);

    // âœ… Ù„Ùˆ Ù…ÙÙŠØ´ Ù†ØªØ§Ø¦Ø¬ â†’ Ù†Ø­ÙˆÙ„Ù‡ Ù„ØµÙØ­Ø© Ø¹Ø±Ø¶ Ø§Ù„ÙÙ†ÙŠÙŠÙ† Ù…Ø¹ Ø§Ù„Ø¨Ø­Ø«
    if (items.length === 0) {
      window.location.href = `/showMoreTechnicians?search=${encodeURIComponent(query)}`;
    } else {
      // âœ… Ù„Ùˆ ÙÙŠÙ‡ Ù†ØªØ§Ø¦Ø¬ â†’ Ø¨Ø±Ø¶Ùˆ Ù†Ø±ÙˆØ­ Ù„ØµÙØ­Ø© Ø§Ù„ÙÙ†ÙŠÙŠÙ† (Ø²ÙŠ Ù…Ø§ Ø·Ù„Ø¨ØªÙŠ Ù‚Ø¨Ù„)
      window.location.href = `/showMoreTechnicians?search=${encodeURIComponent(query)}`;
    }
  } catch (err) {
    console.error("Technician search error:", err);
    displayError();
  }
}


  // ğŸ”¹ Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« Ù„Ù„Ø£Ø­ÙŠØ§Ø¡
  async function searchAndDisplayNeighborhood(query) {
    try {
      const techSlug = searchContainer.dataset.slug || '';
      let url = "";
      
      if (techSlug) {
        url = `/technicians/${techSlug}/neighborhoods/autocomplete?q=${encodeURIComponent(query)}`;
      } else {
        url = `/search/autocomplete?q=${encodeURIComponent(query)}&type=neighborhood`;
      }

      const res = await fetch(url);
      if (!res.ok) throw new Error('Network response was not ok');
      
      const items = await res.json();
      console.log('Neighborhood Search Results:', items);

      if (items.length === 0) {
        displayNoResults(query, 'neighborhood');
      } else if (items.length === 1) {
        const neighSlug = items[0].name.replace(/\s+/g, '-');
        window.location.href = `/technicians/Ø¹Ø±Ø¶-Ø§Ù„Ø§Ø­ÙŠØ§Ø¡/${techSlug}/${neighSlug}`;
      }
    } catch(err) {
      console.error("Neighborhood search error:", err);
      displayError();
    }
  }

  function displaySinglePostCard(post) {
    displayMultiplePostsCards([post]);
  }

  function displayMultiplePostsCards(posts) {
    const postsContainer = document.getElementById('posts-container') || 
                          document.getElementById('cards-container') ||
                          document.querySelector('.grid');
    
    if (!postsContainer) return;

    postsContainer.innerHTML = posts.map(post => {
      // ğŸ”¹ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ØµØ­ÙŠØ­ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù‚Ø§Ù„
      let postUrl = '';
      if (post.slug && post.permaLink) {
        postUrl = `/posts/${post.slug}`;
      } else if (post.slug) {
        postUrl = `/posts/${post.slug}`;
      } else if (post.permaLink) {
        postUrl = `/posts/${post.permaLink}`;
      } else {
        postUrl = `/posts/${post._id || ''}`;
      }
      
      const regex = /<img.*?src="(.*?)"/;
      const match = regex.exec(post.content || "");
      const descriptionImage = match ? match[1] : '/uploads/posts/default.png';
      
      const safeName = (post.name || post.title || "").replace(/"/g, '&quot;');
      const snippet = (post.content || '').replace(/<img.*?>/g,'').replace(/<[^>]+>/g,'').substring(0, 200);

      return `
        <div class="card bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm relative flex flex-col"
             data-permalink="${post.permaLink || post.slug}"
             data-name="${safeName}">
          <div class="relative w-full">
            <img src="${descriptionImage}" 
                 alt="${post.name || post.title}" 
                 title="${post.name || post.title}"
                 class="w-full h-auto object-cover" />
          </div>
          <div class="card-body p-4 flex flex-col flex-1">
            <h3 class="text-[18px] font-bold text-[#222222]">
              ${post.name || post.title}
            </h3>
            <p class="text-[#5C5C5C] font-normal text-[14px] leading-[200%] mb-5 break-words whitespace-normal overflow-hidden line-clamp-2 md:text-[16px] md:leading-[140%]">
              ${snippet}...
            </p>
            <div class="mt-auto flex gap-2">
              <a href="${postUrl}"
                 class="flex-1 bg-[#2A4759] text-white text-sm text-center h-12 flex items-center justify-center rounded-lg hover:opacity-80 transition-opacity duration-200 mt-2">
                Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯
              </a>
            </div>
          </div>
        </div>
      `;
    }).join('');
  }

  function displayNoResults(query, type = 'blog') {
    const postsContainer = document.getElementById('posts-container') || 
                          document.getElementById('cards-container') ||
                          document.querySelector('.grid');
    
    if (!postsContainer) return;

    let message = '';
    let buttonText = '';
    
    switch(type) {
      case 'blog':
        message = `Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‚Ø§Ù„Ø§Øª ØªØ·Ø§Ø¨Ù‚ "<span class='font-bold text-[#2A4759]'>${query}</span>"`;
        buttonText = 'Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª';
        break;
      case 'technician':
        message = `Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙÙ†ÙŠ ÙŠØ·Ø§Ø¨Ù‚ "<span class='font-bold text-[#2A4759]'>${query}</span>"`;
        buttonText = 'Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙ†ÙŠÙŠÙ†';
        break;
      case 'neighborhood':
        message = `Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­ÙŠ ÙŠØ·Ø§Ø¨Ù‚ "<span class='font-bold text-[#2A4759]'>${query}</span>"`;
        buttonText = 'Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø­ÙŠØ§Ø¡';
        break;
    }

    postsContainer.innerHTML = `
      <div class="col-span-1 sm:col-span-2 lg:col-span-3 text-center text-gray-600 bg-white py-10 rounded-lg shadow">
        <i class="fa-solid fa-circle-exclamation text-3xl mb-3 text-[#2A4759]"></i>
        <p class="text-lg font-semibold mb-2">${message}</p>
        <button onclick="location.reload()" 
                class="bg-[#2A4759] text-white px-6 py-2 rounded-lg hover:opacity-80 transition-opacity">
          <i class="fa-solid fa-rotate-right ml-2"></i>
          ${buttonText}
        </button>
      </div>
    `;
  }

  function displayError() {
    const postsContainer = document.getElementById('posts-container') || 
                          document.getElementById('cards-container') ||
                          document.querySelector('.grid');
    
    if (!postsContainer) return;

    postsContainer.innerHTML = `
      <div class="col-span-1 sm:col-span-2 lg:col-span-3 text-center text-gray-600 bg-white py-10 rounded-lg shadow">
        <i class="fa-solid fa-triangle-exclamation text-orange-400 text-4xl mb-4"></i>
        <p class="text-xl font-semibold mb-2">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨Ø­Ø«</p>
        <p class="text-sm text-gray-500 mb-4">
          Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø«Øª Ù…Ø´ÙƒÙ„Ø© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¨Ø­Ø«. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.
        </p>
        <button onclick="location.reload()" 
                class="bg-[#2A4759] text-white px-6 py-2 rounded-lg hover:opacity-80 transition-opacity">
          <i class="fa-solid fa-rotate-right ml-2"></i>
          Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        </button>
      </div>
    `;
  }

  // Autocomplete
  if (mobileSearchInput && searchType) {
    let debounceTimer;
    
    mobileSearchInput.addEventListener("input", async () => {
      clearTimeout(debounceTimer);
      
      debounceTimer = setTimeout(async () => {
        const query = mobileSearchInput.value.trim();
        const list = document.getElementById("autocomplete-list-mobile");

        if (!query) {
          list.innerHTML = "";
          list.classList.add("hidden");
          selectedPost = null;
          
          if (searchType === "blog") {
            const originalCards = document.querySelector('[data-original-posts]');
            if (originalCards) {
              const postsContainer = document.getElementById('posts-container') || 
                                    document.getElementById('cards-container') ||
                                    document.querySelector('.grid');
              if (postsContainer) {
                postsContainer.innerHTML = originalCards.innerHTML;
              }
            }
          }
          return;
        }

        try {
          let url = "";
          
          if (searchType === "neighborhood") {
            const techSlug = searchContainer.dataset.slug || '';
            if (techSlug) {
              url = `/technicians/${techSlug}/neighborhoods/autocomplete?q=${encodeURIComponent(query)}`;
            } else {
              url = `/search/autocomplete?q=${encodeURIComponent(query)}&type=neighborhood`;
            }
          } else {
            url = `/search/autocomplete?q=${encodeURIComponent(query)}&type=${searchType}`;
          }

          console.log("Fetching from URL:", url);

          const res = await fetch(url);
          if (!res.ok) throw new Error('Network response was not ok');
          
          const items = await res.json();
          console.log(`${searchType} Autocomplete Results:`, items);

          if (!items.length) {
            list.innerHTML = "<li class='px-3 py-2 text-gray-500 text-center text-sm'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</li>";
            list.classList.remove("hidden");
            return;
          }

          list.innerHTML = items.map(item => {
            let display = "";
            let link = "#";

            switch(searchType) {
              case "blog":
                display = item.name || item.title || "Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†";
                return `<li class="px-3 py-2 hover:bg-blue-50 cursor-pointer text-sm border-b last:border-b-0" 
                           data-post='${JSON.stringify(item)}'>${display}</li>`;
              
              case "technician":
  display = item.jobName || item.mainTitle || "ÙÙ†ÙŠ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
  link = `/technicians/${item.slug || item._id}`;
  break;

              
              case "neighborhood":
                display = item.name || "Ø­ÙŠ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
                const techSlug = searchContainer.dataset.slug || '';
                const neighSlug = item.name.replace(/\s+/g, '-');
                link = `/technicians/Ø¹Ø±Ø¶-Ø§Ù„Ø§Ø­ÙŠØ§Ø¡/${techSlug}/${neighSlug}`;
                break;
            }

            return `<li class="px-3 py-2 hover:bg-blue-50 cursor-pointer text-sm border-b last:border-b-0" data-link="${link}">${display}</li>`;
          }).join("");

          list.classList.remove("hidden");

         if (searchType === "blog") {
  list.querySelectorAll("li[data-post]").forEach(li => {
    li.addEventListener("click", () => {
      const post = JSON.parse(li.dataset.post);
      selectedPost = post;
      mobileSearchInput.value = post.name || post.title;
      list.innerHTML = "";
      list.classList.add("hidden");

      searchAndDisplayPost(post.name || post.title);
    });
  });
}
 else {
           list.querySelectorAll("li[data-link]").forEach(li => {
  li.addEventListener("click", () => {
    const selectedText = li.textContent.trim();

    if (searchType === "technician") {
      window.location.href = `/showMoreTechnicians?search=${encodeURIComponent(selectedText)}`;
    } 
    else {
      window.location.href = li.dataset.link;
    }
  });
});

          }

        } catch(err) {
          console.error("Autocomplete error:", err);
          const list = document.getElementById("autocomplete-list-mobile");
          list.innerHTML = "<li class='px-3 py-2 text-red-500 text-center text-sm'>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨Ø­Ø«</li>";
          list.classList.remove("hidden");
        }
      }, 300);
    });

    if (searchType === "blog") {
      mobileSearchInput.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          const query = mobileSearchInput.value.trim();
          if (query) {
            searchAndDisplayPost(query);
          }
        }
      });
    } else if (searchType === "technician") {
      mobileSearchInput.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          const query = mobileSearchInput.value.trim();
          if (query) {
            searchAndDisplayTechnician(query);
          }
        }
      });
    } else if (searchType === "neighborhood") {
      mobileSearchInput.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          const query = mobileSearchInput.value.trim();
          if (query) {
            searchAndDisplayNeighborhood(query);
          }
        }
      });
    }

    document.addEventListener('click', (e) => {
      const list = document.getElementById("autocomplete-list-mobile");
      if (!mobileSearchWrapper.contains(e.target) && e.target !== mobileSearchBtn) {
        list.innerHTML = "";
        list.classList.add("hidden");
      }
    });
  }

  // MOBILE MENU
  const mobileMenuBtn = document.getElementById('mobileMenuBtn');
  const mobileMenu = document.getElementById('mobileMenu');
  const hamburgerIcon = document.getElementById('hamburgerIcon');
  const closeIcon = document.getElementById('closeIcon');
  const overlay = document.getElementById('overlay');

  if (mobileMenu && mobileMenuBtn) {
    const openMenu = () => {
      mobileMenu.style.transform = 'translateX(0)';
      overlay.classList.remove('hidden');
      mobileMenuBtn.setAttribute('aria-expanded', 'true');
      if (hamburgerIcon) hamburgerIcon.classList.add('hidden');
      if (closeIcon) closeIcon.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    };

    const closeMenu = () => {
      mobileMenu.style.transform = 'translateX(100%)';
      overlay.classList.add('hidden');
      mobileMenuBtn.setAttribute('aria-expanded', 'false');
      if (hamburgerIcon) hamburgerIcon.classList.remove('hidden');
      if (closeIcon) closeIcon.classList.add('hidden');
      document.body.style.overflow = '';
    };

    mobileMenuBtn.addEventListener('click', () => {
      const isOpen = mobileMenu.style.transform === 'translateX(0)';
      if (isOpen) closeMenu(); else openMenu();
    });

    overlay.addEventListener('click', closeMenu);

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeMenu();
    });

    mobileMenu.addEventListener('click', (e) => {
      if (e.target.tagName === 'A') setTimeout(closeMenu, 50);
    });
  }

  // MOBILE BLOG TOGGLE
  const mobileBlogBtn = document.getElementById('mobileBlogBtn');
  const mobileBlogList = document.getElementById('mobileBlogList');
  const mobileBlogIcon = document.getElementById('mobileBlogIcon');

  if (mobileBlogBtn) {
    mobileBlogBtn.addEventListener('click', (e) => {
      e.preventDefault();
      if (mobileBlogList) mobileBlogList.classList.toggle('hidden');
      if (mobileBlogIcon) mobileBlogIcon.classList.toggle('rotate-180');
    });
  }

  if (searchType === "blog") {
    const postsContainer = document.getElementById('posts-container') || 
                          document.getElementById('cards-container') ||
                          document.querySelector('.grid');
    if (postsContainer && !document.querySelector('[data-original-posts]')) {
      const backup = document.createElement('div');
      backup.setAttribute('data-original-posts', 'true');
      backup.style.display = 'none';
      backup.innerHTML = postsContainer.innerHTML;
      document.body.appendChild(backup);
    }
  }



  
});
</script>

<script>
document.addEventListener("DOMContentLoaded", async () => {
  // ğŸŸ¢ Ù„Ùˆ Ø§Ø­Ù†Ø§ ÙÙŠ ØµÙØ­Ø© Ø¹Ø±Ø¶ Ø§Ù„ÙÙ†ÙŠÙŠÙ†
  if (window.location.pathname.includes("/showMoreTechnicians")) {
    const params = new URLSearchParams(window.location.search);
    const searchQuery = params.get("search");
    if (!searchQuery) return;

    try {
      // Ø¬Ø±Ø¨ ØªØ¬ÙŠØ¨ Ø§Ù„ÙÙ†ÙŠÙŠÙ† Ø§Ù„Ù„ÙŠ Ø¨ÙŠØ·Ø§Ø¨Ù‚ÙˆØ§ Ø§Ù„Ø¨Ø­Ø«
      const res = await fetch(`/search/autocomplete?q=${encodeURIComponent(searchQuery)}&type=technician`);
      const items = await res.json();

      if (items.length === 0) {
        const container = document.getElementById("techniciansContainer") ||
                          document.querySelector(".grid") ||
                          document.body;
        if (container) {
          container.innerHTML = `
           <div class="text-center text-gray-600 bg-white py-10 rounded-lg shadow mx-auto w-[90%] sm:w-[80%] md:max-w-lg">
  <i class="fa-solid fa-circle-exclamation text-3xl mb-3 text-[#2A4759]"></i>
  <p class="text-lg font-semibold mb-2">
    Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙÙ†ÙŠ ÙŠØ·Ø§Ø¨Ù‚ "<span class='font-bold text-[#2A4759]'>${searchQuery}</span>"
  </p>
  <button
    onclick="window.location.href='/showMoreTechnicians'"
    class="bg-[#2A4759] text-white px-6 py-2 rounded-lg hover:opacity-80 transition-opacity"
  >
    <i class="fa-solid fa-rotate-right ml-2"></i>
    Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙ†ÙŠÙŠÙ†
  </button>
</div>

          `;
        }
      }
    } catch (err) {
      console.error("Error fetching technicians:", err);
    }
  }
});
</script>


 <style>
    img[alt="logo"] {
  pointer-events: none;
}

  </style>