<% if (message) { %>
  <% 
    let imgSrc = "";
    if (messageType === "delete") {
      imgSrc = "/static/dashboard/images/delete-success.png";
    } else if (messageType === "add") {
      imgSrc = "/static/dashboard/images/add-success.png";
    }else if (messageType === "edit") {
      imgSrc = "/static/dashboard/images/add-success.png";
    }
  %>
  <style>
    #successMessage {
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    #successMessage.show {
      opacity: 1;
    }
    #successMessage.fade-out {
      opacity: 0;
    }
  </style>

  <div id="successMessage" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
    <div class="bg-white rounded-xl p-10 w-[90%] max-w-md text-center relative">
      <button onclick="removeMessage()" class="absolute top-3 right-3 bg-sky-950 w-6 h-6 flex justify-center text-white items-center p-1 rounded-md font-medium hover:font-bold text-md">Ã—</button>
      <img src="<%= imgSrc %>" alt="Success" class="mx-auto mb-4 w-50" >
      <p class="text-2xl font-bold"><%= message %></p>
    </div>
  </div>

  <script>
    const successMessage = document.getElementById('successMessage');

    // Fade in
    requestAnimationFrame(() => {
      successMessage.classList.add('show');
    });

    function removeMessage() {
      // Immediately remove without fade (called by close button)
      if (successMessage) successMessage.remove();
      clearMessageFromURL();
    }

    function clearMessageFromURL() {
      const url = new URL(window.location);
      url.searchParams.delete('message');
      url.searchParams.delete('messageType');
      window.history.replaceState({}, document.title, url.toString());
    }

    // After 3s, start fade out, then remove after transition ends
    setTimeout(() => {
      successMessage.classList.remove('show');
      successMessage.classList.add('fade-out');
      
      // Wait for CSS transition to finish (400ms), then remove element & clear URL
      successMessage.addEventListener('transitionend', () => {
        removeMessage();
      }, { once: true });
    }, 3000);
  </script>
<% } %>
